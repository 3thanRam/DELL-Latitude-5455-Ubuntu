# Dell Latitude 5455 Channel Remapping via Loopback
# Creates a stereo sink that maps to the 4-channel hardware

context.modules = [
    {
        name = libpipewire-module-loopback
        args = {
            node.name = "Dell-5455-Stereo-Remap"
            node.description = "Dell 5455 Speakers (Stereo)"
            audio.position = [ FL FR ]

            capture.props = {
                media.class = "Audio/Sink"
                audio.channels = 2
                audio.position = [ FL FR ]
            }

            playback.props = {
                node.target = "alsa_output.platform-sound.HiFi__Speaker__sink"
                audio.channels = 4
                audio.position = [ FL RL FR RR ]
                stream.dont-remix = false
                channelmix.upmix = true
                # Map our stereo input to 4-ch output:
                # FL (input) -> FL (ch0) - left speaker
                # FR (input) -> RL (ch2) - right speaker  
                channelmix.upmix-method = "psd"
                node.passive = true
            }
        }
    }
]

